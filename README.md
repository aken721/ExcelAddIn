# ExcelAddIn

### 说明：
本项目为个人维护的开源项目，完全免费可放心使用。如果您喜欢该项目，请多点Star给予鼓励。不胜感谢！

#### 本次更新情况

**2025-11-18**
v2.4.6.2 主要更新内容：
修复批量生成word文档时，模板中多个相同的图片占位符只被替换一次的问题。

**2025-11-08**
v2.4.6.1 主要更新内容：
1. 增加pdf（或图片）电子发票的数据提取功能，采用PaddleOCR进行图像识别，可批量提取pdf格式或图片格式的电子发票信息到excel表格；新功能支持电子发票的批量管理，结合以前已上线的xml数电票管理，覆盖了xml、pdf、图片等多种格式的电子发票。
2. 将2.4.5.2新增功能一并打包，发布v2.4.6.1安装版。

**2025-11-06**
v2.4.5.2 主要更新内容：
1. 新写了一个Html编辑控件，合并到本项目，替换邮件发送中原有的富文本控件，实现可发送html邮件功能
2. 优化了邮件发送的信息提示和进度条显示逻辑

**2025-10-09**
发布v2.4.5版本，新增excel-mcp工具，同时修复一些问题。excel-mcp工具已达到63个，覆盖excel的绝大多数基本操作。主要mcp工具有：
| 分类 | 工具数量 | 主要功能 |
|------|---------|---------|
| 工作簿操作 | 7 | 创建、打开、保存、关闭工作簿 |
| 工作表操作 | 9 | 创建、重命名、删除、复制、移动、隐藏工作表 |
| 数据操作 | 8 | 读写单元格、范围、公式 |
| 格式化 | 14 | 字体、颜色、边框、合并单元格、文本换行、缩进、旋转 |
| 命名区域 | 4 | 创建、删除、获取命名区域 |
| 行列操作 | 8 | 插入、删除、显示/隐藏、调整大小 |
| 查找搜索 | 2 | 查找值、查找替换 |
| 视图布局 | 6 | 冻结窗格、自动调整大小 |
| 批注管理 | 3 | 添加、删除、获取批注 |
| 超链接 | 3 | 添加超链接对象、HYPERLINK公式、删除超链接 |
| 数据分析 | 4 | 统计信息、获取范围、最后行列 |
| 排序筛选 | 3 | 排序、筛选、去重 |
| 图表操作 | 1 | 创建图表 |
| 数据透视表 | 1 | 创建数据透视表 |
| 表格操作 | 2 | 创建表格、获取表格名 |
| 当前选择 | 1 | 获取当前选中单元格信息 |
| 其他高级 | 6 | 数据验证、条件格式、公式验证等 |

**2025-10-01**
发布v2.4.4版本，完成C#下的excel-mcp工具构建，增加deepseek对excel-mcp支持，现在可以在deepseek对话中使用自然语言操作excel表了。

**2025-07-03**
发布v2.4.3版本，根据网友需求增加api获取数据导入Excel功能

**2025-06-25**
发布2.4.2版本，紧急修复了批量生成文档中的几个问题，并且增加了两个新的功能：
1.word文档中的占位符替换插入支持图片插入，在excel中写入图片文件的全路径名称，会自动将图片插入到word文档的同名占位符处；
2.同时支持doc格式和docx格式，会根据模板文件格式，自动选择生成的文档格式。

**2025-06-24**
昨日上传2.4.1版本安装文件在打包时出了点问题，wps无法正常识别插件。今天重新上传安装包，昨天已安装的请重新下载安装程序。新的安装包同时优化了数据库表导入excel时的业务逻辑，避免出现长数字导入时被转为科学计数法的问题。
*另外，因为引用库文件版本冲突问题，安装包安装后无法连接postgresql数据库了（仅安装包使用时存在该问题，源码生成后在测试环境仍可使用），目前正在想办法解决。如果需要该功能的，请拉取源码在调试环境使用。

**2025-06-23**
v2.4.1，主要更新内容：
1.新增标准文档的批量生成。可在标准格式内容的word文档中，对于不同内容的部分设置占位符，并通过Excel表格批量进行占位符替换，实现一个word文档模板生成批量不同文档。主要应用场景包括：
同一标准合同文本模板的批量生成，对于合同签订双方、合同编号、金额等内容进行批量修改生成；人资管理电子文档，进行excel统计向word文档的批量转换......等等等等。
2.这里是列表文本开始开发pdf格式发票的要素批量抓取功能。目前尚未开发完成，暂时在2.4.1版本屏蔽该功能的打开。
3.修正部分UI界面问题。

**2025-04-23**
v2.4.0，主要更新内容：
新增“定时任务”功能，可设置任务计划，按计划自动执行以下五种命令：
1.执行“cmd”命令。将cmd命令行写入文本框内，确认后可在指定时间执行该条命令；
2.执行“vba”命令模块。自动扫描当前excel工作簿的vba函数、子程序和宏命令，按照设定时间执行选择的vba模块。
3.执行“bat”批处理。选择bat文件所在路径，按照设定时间执行该批处理命令。
4.执行“python”脚本。选择“.py”文件所在路径，按照设定时间执行脚本（该功能需自行提前部署python运行环境）。
5.打开程序。选择“.exe”可执行文件所在路径，按照设定时间打开该程序。
任务计划由触发器触发，可按照“一次性”、“每天”、“每周”、“每月”及间隔时间进行设定。

**2025-03-28**
v2.3.9-patch，主要更新内容：
1.文件/文件夹工具中，增加“子目录”选项，选中读取时包含所有子目录，不选时只读取本级目录。默认选中状态。
2.修复读文件时，重复读取文件名称的问题。

**2025-03-05**
V2.3.9，主要更新内容：
1.表工具中增加“六、图表增强”模块，对Excel图表进行补充，近期已支持“词云图”图表生成，逐步增加更多的数据图表支持；
2.deepseek中，增加“回车发送”配置，优化对话时的输入体验。

**2025-02-12**
v2.3.8，主要更新内容：     
1.deepseek接入，调用api接口对话。注意：使用时请自行前往官网申请api key，进入对话窗口后先配置api key和选择模型（deepseek-v3或deepseek-r1），然后即可对话。
2.优化删除文件设定，对于不支持放入回收站的网络映射盘和U盘，采取提示并确认后直接删除。
3.增加聚光灯可选颜色功能。
4.优化为递归方式读文件，降低读文件时的出错概率。

**2025-02-10** 
拥抱deepseek，若使用请尽快去官网自行申请api key。

**2025-02-03** 
优化删除文件设定，对于不支持放入回收站的网络映射盘和U盘，采取提示并确认后直接删除。

**2024-10-17** 
v2.3.7，增加财务工具板块，第一个功能可对XML格式电子发票进行批量读取，并将主要信息写入Excel，便于记账用电子发票管理。

**2024-10-12** 
分表功能支持多层标题行，且支持标题行中有合并单元格的情况。有需要可自行拉取代码后编译，新功能将发布在下一版本中。

**2024-10-10** 
v2.3.6 修复一些问题，优化摄像头扫码功能，增加扫码成功提示音；升级部分库文件为最新版版

**2024-09-30** 
紧急修复v2.3.4中摄像头扫码时卡顿问题，并将彩色二维码升级为同时支持自定义前景色和背景色，同时加入前、背景色对比差的校验，要求不低于50%。不再打包v2.3.4发行版，直接升级为v2.3.5版本。

**2024-09-29** 
版本更新v2.3.4，增加生成彩色二维码、二维码扫码功能。使用时注意事项：1.彩色二维码只支持前景色为深色；2.扫码支持图片识别和摄像头扫码，但测试中少部分二维码识别不成功（有些图片识别失败但摄像头扫码识别成功）

**2024-09-12**  
重新封装v2.3.3版，增加二维码生成时可添加logo的小功能。

**2024-09-09** 
添加Excel转PDF功能，可选：当前表转PDF、工作簿所有表转为单一PDF、工作簿所有表转为多个PDF等三种转换方式。全部功能包括在v2.3.3安装包内。

 **2024-09-05** 
文件/文件夹工具包添加“批量删除/移动”功能，并对其他功能进行优化。全部功能包括在v2.3.2安装包内。

 **2024-08-28** 
在v2.3.1版本基础上，代码中的“批读文件/文件夹”模块中增加了目录和文件的自动链接功能，可在批读文件时新建的_rename表中对“路径”或“旧文件名/旧目录名”添加链接，点击后可直接打开对应的文件夹或文件。该功能发行版中将在2.3.2版本加入。



#### 介绍
**以下是 Excel-add-in 插件说明**
该插件是以往工作中VBA实现的表中数据批量自动化操作，以及利用Excel表格进行文件管理。近期使用C#对代码进行了重写，并对部分算法进行重构和功能增强，通过VSTO方式便于分发安装。安装者可利用经常接触的Excel进行数据管理和文件管理，增强Excel功能。

#### 软件架构
软件为微软OFFICE的VSTO插件形式，并兼容WPS。


#### 安装教程

1. 下载安装版msi文件，https://gitee.com/aken721/excel-addin/release
因gitee不支持上传超过100M文件，如果找不到安装包，请移步到[github](https://github.com/aken721/ExcelAddIn/releases)或[gitcode](https://gitcode.com/aken721/Excel-AddIn/releases)下载
2. 打开Excel后会自动加载
3. 加载后会在Excel的功能区增加“工具箱”选项卡

#### 使用说明

1.  Excel表处理增强模块，可实现一键分表、分簿、合并表、合并工作簿、批量删除表、批量建立空白表等功能，具体细节可参考插件内帮助。 **近期增加1.词云图，以单元格作为一个词语整体，统计词频并生成词云图；2.数据库表导出至Excel功能，支持Oracle、SQL SERVER、MySQL、Access、SQLite、PostgreSQL等多种关系型数据库。** 
2.  Excel表处理中增加“聚光灯”功能，打开该功能后可在鼠标点击单元格式高亮显示所在的行和列（打开该功能会清理原有单元格填充色，但关闭该功能后会自动回复原有填充色）；
3.  Email群发功能，支持针对不同收件人自动群发不同的附件；
4.  批量修改文件名/目录名、批量删除或移动文件/目录：对指定目录下的文件/子目录，读取进入Excel表格，“A列”为源文件/目录路径，“B列”为源文件名/目录名，“C列”为新文件名/目录名。只需通过Excel表的查找、替换、分列等功能，编辑"C列”后，即可高度定制化地批量修改文件名/目录名，或批量删除（移动）文件名/目录名；
5.  Excel转为PDF功能，可选：当前表转PDF、工作簿所有表转为单一PDF、工作簿所有表转为多个PDF等三种转换方式，并可设定页面大小、页面方向和页面缩放比例等。
6.  批量修改MP3歌名：将网络下载常见的“演唱者-歌名” 或 “歌名-演唱者”的MP3文件名形式，批量替换为仅显示歌名的形式，缩短文件名长度。
7.  播放音乐：在操作excel表的同时播放指定文件夹内的音乐，目前支持“mp3、wav、flac、aiff、wma、aac、g711、mp4”等音乐格式。
8.  接入deepseek。

#### 联系方式
如有个性化需求，或对相关功能有优化建议，可发email至aken721@163.com，会及时查看并回复沟通。




#### 代码安全报告

[![Security Status](https://www.murphysec.com/platform3/v31/badge/1684046904480055296.svg)](https://www.murphysec.com/console/report/1684046904182259712/1684046904480055296)
